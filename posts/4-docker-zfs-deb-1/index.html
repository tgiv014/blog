<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Docker & ZFS On Debian | mntn.dev</title>
<meta name=keywords content="hosting,docker,zfs,linux,debian">
<meta name=description content="A look at the setup of my home server.">
<meta name=author content="Thomas Gorham">
<link rel=canonical href=https://mntn.dev/posts/4-docker-zfs-deb-1/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://mntn.dev/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://mntn.dev/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://mntn.dev/favicon-32x32.png>
<link rel=apple-touch-icon href=https://mntn.dev/apple-touch-icon.png>
<link rel=mask-icon href=https://mntn.dev/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.4">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Docker & ZFS On Debian">
<meta property="og:description" content="A look at the setup of my home server.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://mntn.dev/posts/4-docker-zfs-deb-1/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-10-03T09:45:00-05:00">
<meta property="article:modified_time" content="2020-10-03T09:45:00-05:00"><meta property="og:site_name" content="mntn.dev">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Docker & ZFS On Debian">
<meta name=twitter:description content="A look at the setup of my home server.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://mntn.dev/posts/"},{"@type":"ListItem","position":2,"name":"Docker \u0026 ZFS On Debian","item":"https://mntn.dev/posts/4-docker-zfs-deb-1/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Docker \u0026 ZFS On Debian","name":"Docker \u0026 ZFS On Debian","description":"A look at the setup of my home server.","keywords":["hosting","docker","zfs","linux","debian"],"articleBody":"  How’d we Get Here… A while back, I snagged a Dell R710 from Ebay for $350 delivered. This thing is a virtualization monster. 8 cores and 144GB of ECC RAM, perfect for filling with bhyve virtual machines on FreeNAS. This setup worked great for me until I became interested in Docker containers. FreeNAS just doesn’t support a docker environment, so let’s build something from the ground up and document the process.\nConstraints  Must use ZFS (no need for ZFS root) Native docker support Lightweight (no GUI, unnecessary package systems *cough cough snaps*, etc.)  With these constraints, we know we absolutely must use Linux and we would really like a distro that has openzfs in its package control. In the past I’ve used Ubuntu Server and ubuntu 16.04 has zfs available as a package, but I want to avoid snaps like the plague. Because of this, I’m going to use Debian.\nInitial Setup First things first, we’re going to shut down the server and remove every drive but our desired boot drive. FreeNAS uses a flash drive as its root storage, but debian doesn’t quite support that. In my case, I’m going to use an old 120GB SSD in an optical drive caddy in place of the server’s disk drive. It’s easy enough to complete the guided install, and Debian has some pretty good installation literature:\n Installation Guide - Long Installation Howto - Short  I do have a few gotchas during the guided install:\n Some NICs require closed-source firmware to operate. The NIC in my R710 is one of those, so I had to use the non-free debian image. Guided partitioning failed for my install. I suspect that this is because it was trying to make a gigantic swap partition to match the 144GB of RAM. I decided not to use a swap partition and partition the entire SSD as /. I avoided giving root a password. Instead, I have an administrator user with sudo access. I did not install any desktop environments or X server components. Don’t forget to select openssh!  Post-Install Now that we have a fully running debian system, let’s change a few things. Pop all your drives back in and ssh in.\nLet’s gear up to use ssh without a password, starting by setting up private key authentication. If you’re on linux, you’ve got it easy: $ ssh-copy-id $USER@$HOST. On Windows, I find it easiest to manually copy the contents of %HOMEPATH%\\.ssh\\id_rsa.pub to ~/.ssh/authorized_keys on my server. If you don’t have an ~/.ssh/id_rsa.pub or %HOMEPATH%\\.ssh\\id_rsa.pub, you better generate an ssh key with $ ssh-keygen.\nOnce your public key is copied in, it’s a good idea to exit your ssh session and attempt to login with private key auth. If you don’t need a password, you’re on the right path. Time to disable password authentication. In /etc/ssh/sshd_config, find the lines containing the following keys, uncomment them and make sure they’re set to no.\nPasswordAuthentication no ChallengeResponseAuthentication no PermitRootLogin no UsePAM no Now you can reload sshd and bask in paswordless security strong enough to leave exposed publicly. $ sudo /etc/init.d/sshd reload\nZFS Time Debian makes this one super easy. Check the official ZFS Debian Wiki Page for more info. Use the following commands to install ZFS on Debian.\n$ sudo apt update $ sudo apt install linux-headers-`uname -r` $ sudo apt install -t buster-backports dkms sol-dkms $ sudo apt install -t buster-backports zfs-dkms zfsutils-linux It may take a little while to run the dkms build, and it may throw a few warnings. They do not specifically recommend a reboot on the Debian Wiki, but it’s never a bad idea when dealing with kernel modules.\nJust for grins, if you happen to be installing on a system that used to run FreeNAS, you can try to import your old pool with $ sudo zpool import. You’re likely to see action: The pool can be imported using its name or numeric identifier and the '-f' flag.. You can force the import by running $ sudo zpool import -f $POOLNAME.\nIf you’re starting fresh, now is the time to make your first zfs pool. I’m in a bit of a hard drive shortage, so for testing’s sake I will be doing a stripe pool with two 500GB hard drives. ZFS uses disk IDs or paths to reference disks instead of /dev/sdX paths. You can figure out which disk is which with the following commands:\n$ ls -l /dev/disk/by-id $ ls -l /dev/disk/by-path $ lsblk -o NAME,SIZE,MODEL,VENDOR With the device IDs in hand, I’ll make a zpool with:\n$ sudo zpool create tank ata-ST9500325AS_6VESPM0A ata-ST9500325AS_6VESRNXY Docker Install This is essentially a summary of the Docker Docs for Debian.\n Update apt and install required packages:  $ sudo apt update $ sudo apt install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common Get Docker’s GPG key:  $ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - You can verify you have the correct key as follows:\n$ sudo apt-key fingerprint 0EBFCD88 pub 4096R/0EBFCD88 2017-02-22 Key fingerprint = 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88 uid Docker Release (CE deb)  sub 4096R/F273FCD8 2017-02-22 Use the following command to set up Docker stable.  $ sudo add-apt-repository \\ \"deb [arch=amd64] https://download.docker.com/linux/debian \\ $(lsb_release -cs) \\ stable\" Finally, install docker!  $ sudo apt update $ sudo apt install docker-ce docker-ce-cli containerd-io If you want to allow other users to run docker commands, you can set that up as follows:  $ sudo groupadd docker $ sudo usermod -aG docker $USER Log out and back in\n You can verify that your docker install is functional by running hello-world  $ docker run --rm hello-world Let’s Hook up Docker and ZFS This part’s for the adventurous. You could certainly just make a bunch of ZFS datasets with filesystem mounts and mount those in your containers for bulk storage, but that’s no fun! Docker has a ZFS storage driver that will back all container, image, and volume storage with zfs. Let’s set it up.\n Kill docker:  $ sudo /etc/init.d/docker stop Back up /var/lib/docker just in case and then delete its contents:  $ sudo cp -au /var/lib/docker /var/lib/docker.bk $ sudo rm -rf /var/lib/docker/* Create a ZFS-backed mountpoint at /var/lib/docker. The official docker instructions suggest making a zpool and mounting it there, but I’ll use a dataset since I already have a zpool configured (name tank).  $ sudo zfs create -o mountpoint=/var/lib/docker tank/docker Tell Docker to use ZFS for its storage driver. In /etc/docker/daemon.json:  { \"storage-driver\": \"zfs\" } Start docker back up and verify you’re using the ZFS storage driver:  $ sudo /etc/init.d/docker start $ docker info Server: Containers: 0 Running: 0 Paused: 0 Stopped: 0 Images: 114 Server Version: 19.03.11 Storage Driver: zfs Zpool: tank Zpool Health: ONLINE Parent Dataset: tank/docker Space Used By Parent: 17283463680 Space Available: 935802788864 Parent Quota: no Compression: off Logging Driver: json-file Cgroup Driver: cgroupfs 🎉 Done! Now we have a server running Debian with Docker using ZFS-backed storage. This would be a great way to put together a NAS setup using samba or NFS with a bunch of self-hosted services. I’ll be using Docker to host a home assistant instance with nginx sitting in front as a reverse proxy.\n","wordCount":"1196","inLanguage":"en","datePublished":"2020-10-03T09:45:00-05:00","dateModified":"2020-10-03T09:45:00-05:00","author":{"@type":"Person","name":"Thomas Gorham"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mntn.dev/posts/4-docker-zfs-deb-1/"},"publisher":{"@type":"Organization","name":"mntn.dev","logo":{"@type":"ImageObject","url":"https://mntn.dev/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://mntn.dev/ accesskey=h title="mntn.dev (Alt + H)">mntn.dev</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://mntn.dev/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
<li>
<a href=https://mntn.dev/projects/ title=projects>
<span>projects</span>
</a>
</li>
<li>
<a href=https://mntn.dev/categories/ title=categories>
<span>categories</span>
</a>
</li>
<li>
<a href=https://mntn.dev/tags/ title=tags>
<span>tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://mntn.dev/>Home</a>&nbsp;»&nbsp;<a href=https://mntn.dev/posts/>Posts</a></div>
<h1 class=post-title>
Docker & ZFS On Debian
</h1>
<div class=post-meta><span title="2020-10-03 09:45:00 -0500 -0500">October 3, 2020</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Thomas Gorham&nbsp;|&nbsp;<a href=https://github.com/tgiv014/blog/posts/4-docker-zfs-deb-1/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header>
<div class=post-content><figure>
<img loading=lazy src=zfs_docker_debian.png>
</figure>
<h1 id=howd-we-get-here>How&rsquo;d we Get Here&mldr;<a hidden class=anchor aria-hidden=true href=#howd-we-get-here>#</a></h1>
<p>A while back, I snagged a Dell R710 from Ebay for $350 delivered. This thing is a virtualization <em>monster</em>. 8 cores and 144GB of ECC RAM, perfect for filling with bhyve virtual machines on FreeNAS. This setup worked great for me until I became interested in Docker containers. FreeNAS just doesn&rsquo;t support a docker environment, so let&rsquo;s build something from the ground up and document the process.</p>
<h1 id=constraints>Constraints<a hidden class=anchor aria-hidden=true href=#constraints>#</a></h1>
<ul>
<li>Must use ZFS (no need for ZFS root)</li>
<li>Native docker support</li>
<li>Lightweight (no GUI, unnecessary package systems *cough cough snaps*, etc.)</li>
</ul>
<p>With these constraints, we know we absolutely must use Linux and we would really like a distro that has openzfs in its package control. In the past I&rsquo;ve used Ubuntu Server and ubuntu 16.04 has zfs available as a package, but I want to avoid snaps like the plague. Because of this, I&rsquo;m going to use Debian.</p>
<h1 id=initial-setup>Initial Setup<a hidden class=anchor aria-hidden=true href=#initial-setup>#</a></h1>
<p>First things first, we&rsquo;re going to shut down the server and remove every drive but our desired boot drive. FreeNAS uses a flash drive as its root storage, but debian doesn&rsquo;t quite support that. In my case, I&rsquo;m going to use an old 120GB SSD in an optical drive caddy in place of the server&rsquo;s disk drive. It&rsquo;s easy enough to complete the guided install, and Debian has some pretty good installation literature:</p>
<ul>
<li><a href=https://www.debian.org/releases/stable/i386/index.en.html>Installation Guide - Long</a></li>
<li><a href=https://www.debian.org/releases/stable/i386/apa.en.html>Installation Howto - Short</a></li>
</ul>
<p>I do have a few gotchas during the guided install:</p>
<ul>
<li>Some NICs require closed-source firmware to operate. The NIC in my R710 is one of those, so I had to use the <a href=https://cdimage.debian.org/cdimage/unofficial/non-free/cd-including-firmware/current/>non-free debian image</a>.</li>
<li>Guided partitioning failed for my install. I suspect that this is because it was trying to make a gigantic swap partition to match the 144GB of RAM. I decided not to use a swap partition and partition the entire SSD as <code>/</code>.</li>
<li>I avoided giving root a password. Instead, I have an administrator user with sudo access.</li>
<li>I did not install any desktop environments or X server components.</li>
<li>Don&rsquo;t forget to select openssh!</li>
</ul>
<h1 id=post-install>Post-Install<a hidden class=anchor aria-hidden=true href=#post-install>#</a></h1>
<p>Now that we have a fully running debian system, let&rsquo;s change a few things. Pop all your drives back in and ssh in.</p>
<p>Let&rsquo;s gear up to use ssh without a password, starting by setting up private key authentication. If you&rsquo;re on linux, you&rsquo;ve got it easy: <code>$ ssh-copy-id $USER@$HOST</code>. On Windows, I find it easiest to manually copy the contents of <code>%HOMEPATH%\.ssh\id_rsa.pub</code> to <code>~/.ssh/authorized_keys</code> on my server. If you don&rsquo;t have an <code>~/.ssh/id_rsa.pub</code> or <code>%HOMEPATH%\.ssh\id_rsa.pub</code>, you better generate an ssh key with <code>$ ssh-keygen</code>.</p>
<p>Once your public key is copied in, it&rsquo;s a good idea to exit your ssh session and attempt to login with private key auth. If you don&rsquo;t need a password, you&rsquo;re on the right path. Time to disable password authentication. In <code>/etc/ssh/sshd_config</code>, find the lines containing the following keys, uncomment them and make sure they&rsquo;re set to <code>no</code>.</p>
<pre tabindex=0><code>PasswordAuthentication no
ChallengeResponseAuthentication no
PermitRootLogin no
UsePAM no
</code></pre><p>Now you can reload sshd and bask in paswordless security strong enough to leave exposed publicly. <code>$ sudo /etc/init.d/sshd reload</code></p>
<h1 id=zfs-time>ZFS Time<a hidden class=anchor aria-hidden=true href=#zfs-time>#</a></h1>
<p>Debian makes this one super easy. Check the <a href=https://wiki.debian.org/ZFS>official ZFS Debian Wiki Page</a> for more info. Use the following commands to install ZFS on Debian.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ sudo apt update
$ sudo apt install linux-headers-<span style=color:#e6db74>`</span>uname -r<span style=color:#e6db74>`</span>
$ sudo apt install -t buster-backports dkms sol-dkms
$ sudo apt install -t buster-backports zfs-dkms zfsutils-linux
</code></pre></div><p>It may take a little while to run the dkms build, and it may throw a few warnings. They do not specifically recommend a reboot on the Debian Wiki, but it&rsquo;s never a bad idea when dealing with kernel modules.</p>
<p>Just for grins, if you happen to be installing on a system that used to run FreeNAS, you can try to import your old pool with <code>$ sudo zpool import</code>. You&rsquo;re likely to see <code>action: The pool can be imported using its name or numeric identifier and the '-f' flag.</code>. You can force the import by running <code>$ sudo zpool import -f $POOLNAME</code>.</p>
<p>If you&rsquo;re starting fresh, now is the time to make your first zfs pool. I&rsquo;m in a bit of a hard drive shortage, so for testing&rsquo;s sake I will be doing a stripe pool with two 500GB hard drives. ZFS uses disk IDs or paths to reference disks instead of /dev/sdX paths. You can figure out which disk is which with the following commands:</p>
<pre tabindex=0><code>$ ls -l /dev/disk/by-id
$ ls -l /dev/disk/by-path
$ lsblk -o NAME,SIZE,MODEL,VENDOR
</code></pre><p>With the device IDs in hand, I&rsquo;ll make a zpool with:</p>
<pre tabindex=0><code>$ sudo zpool create tank ata-ST9500325AS_6VESPM0A ata-ST9500325AS_6VESRNXY
</code></pre><h1 id=docker-install>Docker Install<a hidden class=anchor aria-hidden=true href=#docker-install>#</a></h1>
<p>This is essentially a summary of the <a href=https://docs.docker.com/engine/install/debian/>Docker Docs for Debian</a>.</p>
<ol>
<li>Update apt and install required packages:</li>
</ol>
<pre tabindex=0><code>$ sudo apt update
$ sudo apt install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
</code></pre><ol start=2>
<li>Get Docker&rsquo;s GPG key:</li>
</ol>
<pre tabindex=0><code>$ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
</code></pre><p>You can verify you have the correct key as follows:</p>
<pre tabindex=0><code>$ sudo apt-key fingerprint 0EBFCD88
pub   4096R/0EBFCD88 2017-02-22
      Key fingerprint = 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88
uid                  Docker Release (CE deb) &lt;docker@docker.com&gt;
sub   4096R/F273FCD8 2017-02-22
</code></pre><ol start=3>
<li>Use the following command to set up Docker stable.</li>
</ol>
<pre tabindex=0><code>$ sudo add-apt-repository \
   &quot;deb [arch=amd64] https://download.docker.com/linux/debian \
   $(lsb_release -cs) \
   stable&quot;
</code></pre><ol start=4>
<li>Finally, install docker!</li>
</ol>
<pre tabindex=0><code>$ sudo apt update
$ sudo apt install docker-ce docker-ce-cli containerd-io
</code></pre><ol start=5>
<li>If you want to allow other users to run docker commands, you can set that up <a href=https://docs.docker.com/engine/install/linux-postinstall/>as follows</a>:</li>
</ol>
<pre tabindex=0><code>$ sudo groupadd docker
$ sudo usermod -aG docker $USER
</code></pre><p>Log out and back in</p>
<ol>
<li>You can verify that your docker install is functional by running <code>hello-world</code></li>
</ol>
<pre tabindex=0><code>$ docker run --rm hello-world
</code></pre><h1 id=lets-hook-up-docker-and-zfs>Let&rsquo;s Hook up Docker and ZFS<a hidden class=anchor aria-hidden=true href=#lets-hook-up-docker-and-zfs>#</a></h1>
<p>This part&rsquo;s for the adventurous. You could certainly just make a bunch of ZFS datasets with filesystem mounts and mount those in your containers for bulk storage, but that&rsquo;s no fun! Docker has a <a href=https://docs.docker.com/storage/storagedriver/zfs-driver/>ZFS storage driver</a> that will back all container, image, and volume storage with zfs. Let&rsquo;s set it up.</p>
<ol>
<li>Kill docker:</li>
</ol>
<pre tabindex=0><code>$ sudo /etc/init.d/docker stop
</code></pre><ol start=2>
<li>Back up /var/lib/docker just in case and then delete its contents:</li>
</ol>
<pre tabindex=0><code>$ sudo cp -au /var/lib/docker /var/lib/docker.bk
$ sudo rm -rf /var/lib/docker/*
</code></pre><ol start=3>
<li>Create a ZFS-backed mountpoint at <code>/var/lib/docker</code>. The official docker instructions suggest making a zpool and mounting it there, but I&rsquo;ll use a dataset since I already have a zpool configured (name <code>tank</code>).</li>
</ol>
<pre tabindex=0><code>$ sudo zfs create -o mountpoint=/var/lib/docker tank/docker
</code></pre><ol start=4>
<li>Tell Docker to use ZFS for its storage driver. In <code>/etc/docker/daemon.json</code>:</li>
</ol>
<pre tabindex=0><code>{
  &quot;storage-driver&quot;: &quot;zfs&quot;
}
</code></pre><ol start=5>
<li>Start docker back up and verify you&rsquo;re using the ZFS storage driver:</li>
</ol>
<pre tabindex=0><code>$ sudo /etc/init.d/docker start
$ docker info
Server:
 Containers: 0
  Running: 0
  Paused: 0
  Stopped: 0
 Images: 114
 Server Version: 19.03.11
 Storage Driver: zfs
  Zpool: tank
  Zpool Health: ONLINE
  Parent Dataset: tank/docker
  Space Used By Parent: 17283463680
  Space Available: 935802788864
  Parent Quota: no
  Compression: off
 Logging Driver: json-file
 Cgroup Driver: cgroupfs
</code></pre><h1 id=-done>🎉 Done!<a hidden class=anchor aria-hidden=true href=#-done>#</a></h1>
<p>Now we have a server running Debian with Docker using ZFS-backed storage. This would be a great way to put together a NAS setup using samba or NFS with a bunch of self-hosted services. I&rsquo;ll be using Docker to host a home assistant instance with nginx sitting in front as a reverse proxy.</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://mntn.dev/tags/hosting/>hosting</a></li>
<li><a href=https://mntn.dev/tags/docker/>docker</a></li>
<li><a href=https://mntn.dev/tags/zfs/>zfs</a></li>
<li><a href=https://mntn.dev/tags/linux/>linux</a></li>
<li><a href=https://mntn.dev/tags/debian/>debian</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://mntn.dev/posts/1-project-euler-15/>
<span class=title>« Prev Page</span>
<br>
<span>Project Euler Problem #15</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://mntn.dev/>mntn.dev</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>